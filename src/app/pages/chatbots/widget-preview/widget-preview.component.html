<div class="widget-preview-container">
  @if (config) {
    <!-- Simulación del sitio web -->
    <div class="preview-website">
      <div class="website-header">
        <div class="website-logo"></div>
        <div class="website-nav">
          <div class="nav-item"></div>
          <div class="nav-item"></div>
          <div class="nav-item"></div>
        </div>
      </div>
      
      <div class="website-content">
        <div class="content-block"></div>
        <div class="content-block small"></div>
        <div class="content-block medium"></div>
      </div>
    </div>

    <!-- Widget flotante -->
    <div class="widget-container">
      <!-- Burbuja del chat -->
      <div 
        class="chat-bubble {{ getAnimationClass() }}"
        [ngStyle]="bubbleStyles"
        (click)="toggleChat()"
      >
        <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
          @if (isOpen) {
            <!-- Icono X para cerrar -->
            <path d="M18.36 6.64a1 1 0 0 0-1.41 0L12 11.59 7.05 6.64a1 1 0 1 0-1.41 1.41L10.59 13l-4.95 4.95a1 1 0 0 0 1.41 1.41L12 14.41l4.95 4.95a1 1 0 0 0 1.41-1.41L13.41 13l4.95-4.95a1 1 0 0 0 0-1.41z"/>
          } @else {
            <!-- Icono de chat -->
            <path d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"/>
          }
        </svg>
      </div>

      <!-- Ventana de chat -->
      <div 
        class="chat-window {{ getAnimationClass() }}"
        [ngStyle]="chatStyles"
      >
        <!-- Header del chat -->
        @if (config.chat.showHeader) {
          <div class="chat-header" [ngStyle]="getHeaderStyles()">
            <div class="header-content">
              @if (config.chat.showAvatar && config.chat.avatarUrl) {
                <img 
                  [src]="config.chat.avatarUrl" 
                  [alt]="config.chat.headerTitle"
                  class="header-avatar"
                >
              }
              <div class="header-text">
                <h4 class="header-title">{{ config.chat.headerTitle }}</h4>
                @if (config.chat.headerSubtitle) {
                  <p class="header-subtitle">{{ config.chat.headerSubtitle }}</p>
                }
              </div>
            </div>
          </div>
        }

        <!-- Cuerpo del chat -->
        <div class="chat-body">
          <!-- Mensaje de bienvenida -->
          <div class="message bot-message">
            @if (config.chat.showAvatar && config.chat.avatarUrl) {
              <img 
                [src]="config.chat.avatarUrl" 
                [alt]="'Bot'"
                class="message-avatar"
              >
            } @else {
              <div class="message-avatar-placeholder">
                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"/>
                </svg>
              </div>
            }
            <div class="message-content">
              <div class="message-bubble">
                {{ config.chat.welcomeMessage }}
              </div>
              @if (config.chat.showTimestamps) {
                <span class="message-time">Ahora</span>
              }
            </div>
          </div>

          <!-- Indicador de escritura (si está habilitado) -->
          @if (config.chat.showTypingIndicator) {
            <div class="typing-indicator">
              <div class="typing-dots">
                <span></span>
                <span></span>
                <span></span>
              </div>
            </div>
          }
        </div>

        <!-- Input del chat -->
        <div class="chat-input">
          <div class="input-container">
            @if (config.chat.allowFileUpload) {
              <button class="file-button">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13"/>
                </svg>
              </button>
            }
            <input 
              type="text" 
              class="message-input"
              [placeholder]="config.chat.placeholderText"
              [style.font-family]="config.appearance.fontFamily"
              [style.font-size.px]="config.appearance.fontSize"
            >
            <button class="send-button" [style.background-color]="config.appearance.primaryColor">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"/>
              </svg>
            </button>
          </div>
        </div>

        <!-- Powered by (si está habilitado) -->
        @if (config.chat.showPoweredBy) {
          <div class="powered-by">
            @if (config.chat.customBranding) {
              <span>{{ config.chat.customBranding }}</span>
            } @else {
              <span>Powered by OneBot</span>
            }
          </div>
        }
      </div>
    </div>
  }
</div>
